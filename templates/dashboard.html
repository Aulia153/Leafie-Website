<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Leafie â€” Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <!-- HEADER -->
  <header class="header">
    <div class="container nav">
      <div class="logo">
        <img src="{{ url_for('static', filename='image/logo.png') }}" alt="logo">
        <span>Leafie</span>
      </div>
      <div class="nav-links">
        <a href="{{ url_for('auth_bp.logout') }}" class="nav-link">Logout</a>
      </div>
    </div>
  </header>

  <!-- HERO -->
  <section class="hero">
    <div class="hero-overlay">
      <h1>Dashboard</h1>
      <p>Monitoring tanaman secara real-time dengan kontrol kamera & pompa otomatis</p>
    </div>
  </section>

  <!-- MAIN CONTENT -->
  <main class="main-content container">

    <!-- Kamera -->
    <section class="section">
      <h2 class="section-title">Kamera Monitoring</h2>
      <div class="grid-2">
        <div class="card camera-card">
          <img id="cameraFeed" src="{{ url_for('video_feed') }}" alt="Live Camera" class="camera-frame">
        </div>
        <div class="card camera-control">
          <button id="cameraBtn" class="btn btn-outline">Matikan Kamera</button>
        </div>
      </div>
    </section>

    <!-- Suhu & Kelembapan -->
    <section class="section">
      <h2 class="section-title">Suhu & Kelembapan</h2>
      <p class="section-subtitle">Update otomatis tiap 5 detik</p>

      <div class="grid-2">
        <div class="card temp-display">
          <div class="temp-label">Suhu Saat Ini</div>
          <div id="tempValue" class="temp-value">{{ data.temperature }} Â°C</div>
          <div id="timeValue" class="temp-feels">{{ data.timestamp }}</div>
        </div>

        <div class="card">
          <canvas id="tempChart" class="chart"></canvas>
        </div>
      </div>
    </section>

    <!-- Kelembapan Tanah -->
    <section class="section">
      <h2 class="section-title">Kelembapan Tanah</h2>
      <div class="grid-2">
        <div class="card humidity-card">
          <div class="humidity-label">Kelembapan Saat Ini</div>
          <div id="soilValue" class="humidity-value">{{ data.soil_moisture }}%</div>
          <div id="soilStatus" class="humidity-desc">--</div>
        </div>
        <div class="card">
          <canvas id="soilChart" class="chart"></canvas>
        </div>
      </div>
    </section>

    <!-- Pompa -->
    <section class="section">
      <h2 class="section-title">Kontrol Pompa</h2>
      <div class="grid-2">
        <div class="card pump-control">
          <button id="pumpBtn" class="btn btn-outline">Toggle Pompa</button>
        </div>
        <div id="pumpCard" class="card pump-status">
          <div class="bulb-icon">ðŸ’¡</div>
          <div class="pump-text">Status Pompa: <span id="pumpState">{{ pump_state }}</span></div>
        </div>
      </div>
    </section>

    <!-- Aktivitas -->
    <section class="section">
      <h2 class="section-title">Catatan Aktivitas</h2>
      <div id="activityList" class="activity-list card">
        {% for log in activity %}
        <div class="activity-item">
          <div class="activity-content">
            <div class="activity-time">{{ log.time }}</div>
            <div class="activity-desc">{{ log.desc }}</div>
          </div>
        </div>
        {% endfor %}
      </div>
    </section>

    <!-- Ekspor -->
    <section class="section">
      <button id="exportBtn" class="btn">Download CSV (History)</button>
    </section>
  </main>

  <footer class="footer">
    <div class="container">
      <p>Â© 2025 Leafie â€” All Rights Reserved</p>
    </div>
  </footer>

  <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>

</html>
